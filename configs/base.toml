window_titles = []

[env]
backend = "windows"
obs_width = 96
obs_height = 96
frame_stack = 4
game_over_on_health_missing = true
health_missing_patience = 3
action_pause_on_health_missing_s = 1.0
game_over_template = ""
game_over_threshold = 0.92
post_game_over_delay_s = 0.2
reset_ready_template = ""
reset_ready_threshold = 0.92
reset_ready_timeout_s = 6.0
reset_ready_poll_s = 0.05
round_start_timeout_s = 6.0
round_start_poll_s = 0.05

[env.window]
title_regex = "Irisu syndrome"
window_index = 0
focus_before_step = true

[env.window.capture_region]
left = 630
top = 285
width = 650
height = 480

[env.action_grid]
rows = 8
cols = 8
left = 786
top = 358
right = 1073
bottom = 685

[env.reward]
survival_reward = 0.01
activity_reward_scale = 0.15
cascade_threshold = 0.18
cascade_bonus = 0.25
stale_threshold = 0.01
stale_patience = 90
stale_penalty = -0.25
score_delta_scale = 0.002
score_value_scale = 0.02
score_value_log_max = 50000.0
health_value_scale = 0.03
health_delta_scale = 0.5

[env.hud_features]
enabled = true
score_log_max = 50000.0

[env.episode]
max_steps = 5000
action_repeat = 1
click_hold_s = 0.01
max_clicks_per_second = 3.0
inter_step_sleep_s = 0.0

[[env.game_over_macro]]
kind = "click"
x = 325
y = 240
button = "left"
relative_to_capture = true
duration_s = 0.04

[[env.game_over_macro]]
kind = "sleep"
duration_s = 1.0

[[env.reset_macro]]
kind = "click"
x = 403
y = 261
button = "left"
relative_to_capture = true
duration_s = 0.04

[env.score_ocr]
enabled = true
method = "template"
tesseract_cmd = "C:\\Program Files\\Tesseract-OCR\\tesseract.exe"
template_dir = "assets/score_templates"
template_min_similarity = 0.32
template_fallback_to_tesseract = false
template_expected_digits = 8
template_inner_left = 0
template_inner_right = 0
monotonic_non_decreasing = false
score_smoothing_window = 5
max_step_decrease = 1000
outlier_confirm_frames = 2
hold_last_value_when_missing = true
min_confidence = 40.0
max_step_increase = 1000

[env.score_ocr.region]
left = 204
top = 445
width = 223
height = 28

[env.health_bar]
enabled = true
method = "scanline"
# Frame coords (relative to captured frame, not absolute screen):
# x_start = screen_x_start - env.window.capture_region.left
# x_end = screen_x_end - env.window.capture_region.left
# y = screen_y - env.window.capture_region.top
scanline_start_x = 156
scanline_end_x = 463
scanline_y = 441
scanline_half_height = 1
scanline_contrast_threshold = 0.02
column_fill_threshold = 0.04
adaptive_fill_peak_ratio = 0.35
min_visible_pixels = 40
smoothing_window = 5
max_delta_per_step = 0.14
outlier_confirm_frames = 2
fill_direction = "right_to_left"
invert_percent = true
hsv_lower_1 = [0, 70, 40]
hsv_upper_1 = [12, 255, 255]
hsv_lower_2 = [170, 70, 40]
hsv_upper_2 = [179, 255, 255]

# Optional rectangular method (set method = "profile").
# [env.health_bar.region]
# left = 136
# top = 450
# width = 392
# height = 10

[train]
n_envs = 1
total_timesteps = 1000000
n_steps = 256
batch_size = 256
learning_rate = 0.0003
gamma = 0.995
gae_lambda = 0.95
clip_range = 0.2
ent_coef = 0.01
vf_coef = 0.5
max_grad_norm = 0.5
checkpoint_every = 100000
seed = 1
device = "auto"
